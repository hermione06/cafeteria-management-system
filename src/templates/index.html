{% extends "base.html" %}

{% block title %}Home - CafeHub{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="gradient-bg rounded-2xl shadow-2xl overflow-hidden mb-12">
    <div class="px-6 py-20 md:px-12 md:py-32 text-center">
        <h1 class="text-4xl md:text-6xl font-bold text-white mb-6 fade-in">
            Welcome to CafeHub
        </h1>
        <p class="text-xl md:text-2xl text-white/90 mb-8 fade-in">
            Order delicious meals from your campus cafeteria with ease
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center fade-in">
            {% if not session.user_id %}
            <a href="/menu" class="bg-white text-primary px-8 py-4 rounded-lg font-semibold hover:bg-gray-100 transition transform hover:scale-105 shadow-lg">
                <i class="fas fa-book-open mr-2"></i> View Menu
            </a>
            <a href="/register" class="glass-effect text-white px-8 py-4 rounded-lg font-semibold hover:bg-white/20 transition transform hover:scale-105">
                <i class="fas fa-user-plus mr-2"></i> Sign Up Now
            </a>
            {% else %}
            <a href="/menu" class="bg-white text-primary px-8 py-4 rounded-lg font-semibold hover:bg-gray-100 transition transform hover:scale-105 shadow-lg">
                <i class="fas fa-book-open mr-2"></i> Browse Menu
            </a>
            <a href="/orders" class="glass-effect text-white px-8 py-4 rounded-lg font-semibold hover:bg-white/20 transition transform hover:scale-105">
                <i class="fas fa-shopping-cart mr-2"></i> My Orders
            </a>
            {% endif %}
        </div>
    </div>
</div>

<!-- Announcements -->
<div id="announcementsSection" class="mb-12"></div>

<!-- Features Section -->
<div class="mb-12">
    <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">Why Choose CafeHub?</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl transition transform hover:-translate-y-2">
            <div class="bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mb-4">
                <i class="fas fa-clock text-3xl text-primary"></i>
            </div>
            <h3 class="text-xl font-bold text-gray-800 mb-3">Quick & Easy</h3>
            <p class="text-gray-600">Order your favorite meals in seconds and skip the queue</p>
        </div>
        
        <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl transition transform hover:-translate-y-2">
            <div class="bg-green-100 w-16 h-16 rounded-full flex items-center justify-center mb-4">
                <i class="fas fa-utensils text-3xl text-green-600"></i>
            </div>
            <h3 class="text-xl font-bold text-gray-800 mb-3">Fresh Food</h3>
            <p class="text-gray-600">All meals prepared fresh daily with quality ingredients</p>
        </div>
        
        <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-2xl transition transform hover:-translate-y-2">
            <div class="bg-purple-100 w-16 h-16 rounded-full flex items-center justify-center mb-4">
                <i class="fas fa-bell text-3xl text-purple-600"></i>
            </div>
            <h3 class="text-xl font-bold text-gray-800 mb-3">Real-time Updates</h3>
            <p class="text-gray-600">Track your order status from preparation to pickup</p>
        </div>
    </div>
</div>

<!-- Popular Items -->
<div class="mb-12">
    <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">Popular Items</h2>
    <div id="popularItems" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6">
        <!-- Items will be loaded via JavaScript -->
    </div>
</div>

<!-- Stats Section -->
<div class="bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl shadow-2xl p-12 text-white mb-12">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
        <div>
            <div class="text-5xl font-bold mb-2">500+</div>
            <div class="text-xl text-white/80">Happy Customers</div>
        </div>
        <div>
            <div class="text-5xl font-bold mb-2">50+</div>
            <div class="text-xl text-white/80">Menu Items</div>
        </div>
        <div>
            <div class="text-5xl font-bold mb-2">1000+</div>
            <div class="text-xl text-white/80">Orders Completed</div>
        </div>
    </div>
</div>

<!-- CTA Section -->
{% if not session.user_id %}
<div class="bg-white rounded-2xl shadow-xl p-12 text-center">
    <h2 class="text-3xl font-bold text-gray-800 mb-4">Ready to Get Started?</h2>
    <p class="text-xl text-gray-600 mb-8">Join CafeHub today and enjoy hassle-free meal ordering</p>
    <a href="/register" class="inline-block bg-primary text-white px-8 py-4 rounded-lg font-semibold hover:bg-blue-600 transition transform hover:scale-105 shadow-lg">
        <i class="fas fa-user-plus mr-2"></i> Create Your Account
    </a>
</div>
{% endif %}
{% endblock %}

{% block extra_js %}
<script>
    // Load announcements
    async function loadAnnouncements() {
        try {
            const response = await fetch(`${API_BASE}/announcements`);
            const data = await response.json();
            
            if (data.announcements && data.announcements.length > 0) {
                const container = document.getElementById('announcementsSection');
                const activeAnnouncements = data.announcements.filter(a => 
                    a.title !== "No announcements yet"
                );
                
                if (activeAnnouncements.length > 0) {
                    container.innerHTML = `
                        <div class="bg-blue-50 border-l-4 border-blue-500 p-6 rounded-lg">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">
                                <i class="fas fa-bullhorn mr-2"></i> Announcements
                            </h3>
                            <div class="space-y-3">
                                ${activeAnnouncements.map(ann => `
                                    <div class="bg-white p-4 rounded-lg shadow">
                                        <h4 class="font-bold text-gray-800">${ann.title}</h4>
                                        <p class="text-gray-600 mt-1">${ann.message}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
            }
        } catch (error) {
            console.error('Error loading announcements:', error);
        }
    }
    
    // Load popular items
    async function loadPopularItems() {
        try {
            const response = await fetch(`${API_BASE}/menu?available=true&per_page=4`);
            const data = await response.json();
            
            const container = document.getElementById('popularItems');
            
            if (data.items && data.items.length > 0) {
                container.innerHTML = data.items.map(item => `
                    <div class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-2xl transition transform hover:-translate-y-2">
                        <div class="h-48 bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center">
                            <i class="fas fa-utensils text-6xl text-white"></i>
                        </div>
                        <div class="p-6">
                            <h3 class="text-xl font-bold text-gray-800 mb-2">${item.name}</h3>
                            <p class="text-gray-600 mb-4 text-sm">${item.description || 'Delicious and fresh'}</p>
                            <div class="flex justify-between items-center">
                                <span class="text-2xl font-bold text-primary">$${item.price.toFixed(2)}</span>
                                <span class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm">
                                    <i class="fas fa-check-circle mr-1"></i> Available
                                </span>
                            </div>
                        </div>
                    </div>
                `).join('');
            } else {
                container.innerHTML = `
                    <div class="col-span-full text-center text-gray-500 py-12">
                        <i class="fas fa-utensils text-6xl mb-4"></i>
                        <p class="text-xl">No items available at the moment</p>
                    </div>
                `;
            }
        } catch (error) {
            console.error('Error loading popular items:', error);
        }
    }
    
    // Load data on page load
    document.addEventListener('DOMContentLoaded', function() {
        loadAnnouncements();
        loadPopularItems();
    });
</script>
{% endblock %}